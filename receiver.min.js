'use strict';var APP_VERSION=1;$.app_Configuration=new function(){this.debug=-1==navigator.userAgent.indexOf("CrKey");this.blurredBackground=this.cropCenter=this.track=this.logo=this.time=this.weather=!0;this.icon;this.name;this.label;this.device};$.app_Status=new function(){this.foreground=this.started=this.ready=this.initialized=!1;this.nextTrackInfo=this.currentTrackInfo=null};$.app_Request=function(){this.url;this.sender;this.token;this.title;this.album;this.width;this.height};
$.app_Message=function(a,b){this.type=a;this.msg=b};
$.fn.app_onInitialize=function(){$.app_Status.initialized||($().time_initialize(),$().weather_initialize(),$().app_onConfigurationChanged($.app_Configuration),$("#photo-details").on("transitionend webkitTransitionEnd",function(){$.fn.app_onUpdateTrackInfo();$.app_Status.started?$("#photo-details, #album-details").removeClass().addClass("fadein delayed800 duration800"):$("#photo-details, #album-details").removeClass().addClass("fadeout")}),$.app_Status.initialized=!0)};
$.fn.app_onReady=function(){$.app_Status.ready||($.app_Status.ready=!0,$().app_sendBroadcastMessage(new $.app_Message("ready",'{"v":'+APP_VERSION+"}")))};
$.fn.app_onConfigurationChanged=function(a){$("#splash-icon, #appinfo-logo").css("background","url("+a.icon+") no-repeat center").css("background-size","cover");$.app_Status.started||$("#splash").waitForImages(function(){$("#splash").removeClass().addClass("fadein");setTimeout("$().app_onReady();",1500)},$.noop,!0);$().time_configuration_changed(a);$().weather_configuration_changed(a);$("#splash-title").text(a.name);$("#splash-subtitle").text(a.label);$("#appinfo-name").text(a.name);$("#appinfo-device").text(a.device);
$("#loading-text").text(a.loadingMsg);a.logo?$("#appinfo").css("display","block"):$("#appinfo").css("display","none");a.track?($("#photo-details").css("display","block"),$("#album-details").css("display","block")):($("#photo-details").css("display","none"),$("#album-details").css("display","none"))};var pp_splash_transtion_registered=!1;
$.fn.app_onStart=function(a){if(!$.app_Status.started&&($.app_Status.started=!0,$("#splash").removeClass().addClass("fadeout"),!pp_splash_transtion_registered))$("#splash").on("transitionend webkitTransitionEnd",function(){$("#splash").hasClass("fadeout")&&($.fn.app_onUpdateTrackInfo(),$.app_Status.started?($("#media").removeClass().addClass("fadein"),a.removeClass().addClass("fadein"),$("#backdrop").removeClass().addClass("fadein delayed"),$().app_onNotifyTrackLoaded()):$("#media-fg-normal, #media-fg-blur, #media-bg-normal, #media-bg-blur").css("background",
"url() no-repeat center"))})};var pp_backdrop_transtion_registered=!1;$.fn.app_onStop=function(){if($.app_Status.started&&($.app_Status.started=!1,$("#backdrop, #media").removeClass().addClass("fadeout"),$.app_Status.currentTrackInfo=null,!pp_backdrop_transtion_registered))$("#backdrop, #media").on("transitionend webkitTransitionEnd",function(){$("#backdrop").hasClass("fadeout")&&$("#splash").removeClass().addClass("fadein")})};
$.fn.app_onRequest=function(a){$().app_onShowLoading(!0);$.app_Status.nextTrackInfo=a;setTimeout("$().app_onPerformRequest();",300)};
$.fn.app_onPerformRequest=function(){var a=$(document).width()/$(document).height(),b=$.app_Status.nextTrackInfo.width/$.app_Status.nextTrackInfo.height,a=$.app_Configuration.cropCenter&&.5>=Math.abs(a-b),c="#media-"+($.app_Status.foreground?"fg":"bg"),d="#media-"+($.app_Status.foreground?"bg":"fg"),e=$.app_Status.started;$(d+"-normal").css("background","url("+$.app_Status.nextTrackInfo.url+") no-repeat center").css("background-size",a?"cover":"contain");!a&&$.app_Configuration.blurredBackground?
$(d+"-blur").css("background","url("+$.app_Status.nextTrackInfo.url+") no-repeat center").css("background-size","cover"):$(d+"-blur").css("background","#303030 no-repeat center");$(d).waitForImages(function(){$().app_onShowLoading(!1);$.app_Status.currentTrackInfo=$.app_Status.nextTrackInfo;$.app_Status.started?($(c).removeClass().addClass("fadeout"),e==$.app_Status.started?($(d).removeClass().addClass("fadein"),$().app_onNotifyTrackLoaded()):$("#media-fg-normal, #media-fg-blur, #media-bg-normal, #media-bg-blur").css("background",
"url() no-repeat center"),$("#photo-details, #album-details").removeClass().addClass("fadeout duration500")):e==$.app_Status.started?$.fn.app_onStart($(d)):$("#media-fg-normal, #media-fg-blur, #media-bg-normal, #media-bg-blur").css("background","url() no-repeat center");$.app_Status.foreground=!$.app_Status.foreground},function(a,b,c){0!=a||c||$(d+"-normal").css("background","url(404.jpg) no-repeat center").css("background-size","cover")},!0)};
$.fn.app_onShowLoading=function(a){a?($("#loading \x3e div").addClass("on"),$("#loading").fadeIn(250)):$("#loading").fadeOut(150,function(){$("#loading \x3e div").removeClass("on")})};$.fn.app_onUpdateTrackInfo=function(){null!=$.app_Status.currentTrackInfo&&($("#photo-details").html($.app_Status.currentTrackInfo.title),$("#album-details").html($.app_Status.currentTrackInfo.album))};
$.fn.app_onNotifyTrackLoaded=function(){setTimeout("$().app_sendBroadcastMessage(new $.app_Message('track', '"+('{"k":"'+$.app_Status.currentTrackInfo.token+'","s":"'+$.app_Status.currentTrackInfo.sender+'"}')+"'));",2E3)};
$.fn.app_onNewEvent=function(a,b){var c=b.type;"conf"==c?(b.hasOwnProperty("w")&&($.app_Configuration.weather=b.w),b.hasOwnProperty("t")&&($.app_Configuration.time=b.t),b.hasOwnProperty("lg")&&($.app_Configuration.logo=b.lg),b.hasOwnProperty("tr")&&($.app_Configuration.track=b.tr),b.hasOwnProperty("i")&&($.app_Configuration.icon=b.i),b.hasOwnProperty("n")&&($.app_Configuration.name=b.n),b.hasOwnProperty("l")&&($.app_Configuration.label=b.l),b.hasOwnProperty("d")&&($.app_Configuration.device=b.d),
b.hasOwnProperty("cc")&&($.app_Configuration.cropCenter=b.cc),b.hasOwnProperty("bb")&&($.app_Configuration.blurredBackground=b.bb),b.hasOwnProperty("ml")&&($.app_Configuration.loadingMsg=b.ml),$().app_onConfigurationChanged($.app_Configuration)):"cast"==c?(c=new $.app_Request,c.url=b.u,c.sender=b.s,c.token=b.k,c.title=b.t,c.album=b.a,c.width=b.w,c.height=b.h,$().app_onRequest(c)):"ping"==c?$().app_sendMessage(b.senderId,new $.app_Message("pong","{}")):"stop"==c&&$.app_Status.started&&$().app_onStop()};
$.fn.app_sendBroadcastMessage=function(a){$.app_Configuration.debug||window.castMessageBus.broadcast(JSON.stringify(a))};$.fn.app_sendMessage=function(a,b){$.app_Configuration.debug||window.castMessageBus.send(a,JSON.stringify(b))};
$.app_Configuration.debug||(window.castMediaPlayer={editTracksInfo:function(a){},getCurrentTimeSec:function(){return 0},getDurationSec:function(){return 0},getState:function(){return cast.receiver.media.PlayerState.IDLE},getVolume:function(){var a=new cast.receiver.media.Volume;a.level=0;a.muted=!1;return a},load:function(a,b,c,d,e){},pause:function(){},play:function(){},registerEndedCallback:function(a){},registerErrorCallback:function(a){},registerLoadCallback:function(a){},reset:function(){},seek:function(a,
b){},setVolume:function(a){},unregisterEndedCallback:function(){},unregisterErrorCallback:function(){},unregisterLoadCallback:function(){}},window.castMediaManager=new cast.receiver.MediaManager(window.castMediaPlayer),window.castReceiverManager=cast.receiver.CastReceiverManager.getInstance(),window.castReceiverManager.onReady=function(a){$().app_onInitialize()},window.castReceiverManager.onSenderConnected=function(a){$.app_Status.ready&&$().app_sendMessage(a.senderId,new $.app_Message("ready",'{"v":'+
APP_VERSION+"}"))},window.castReceiverManager.onSenderDisconnected=function(a){0==window.castReceiverManager.getSenders().length&&a.reason==cast.receiver.system.DisconnectReason.REQUESTED_BY_SENDER&&window.close()},window.castMessageBus=window.castReceiverManager.getCastMessageBus("urn:x-cast:com.ruesga.android.wallpapers.photophase"),window.castMessageBus.onMessage=function(a){$().app_onNewEvent(a.senderId,JSON.parse(a.data))},window.castReceiverManager.start());$.fn.time_tt=0;$.fn.time_configuration_changed=function(a){a.time?($().time_tick(),$("#time-block").css("display","inline-block")):($("#time-block").css("display","none"),clearTimeout($.fn.time_tt),$.fn.time_tt=0)};$.fn.time_initialize=function(){};
$.fn.time_tick=function(){var a=window.navigator.userLanguage||window.navigator.language,b=moment(),c=moment().startOf("minute").add(1,"minute");$("#time").text(b.locale(a).format("LT"));0!=$.fn.time_tt&&(clearTimeout($.fn.time_tt),$.fn.time_tt=0);$.app_Configuration.time&&($.fn.time_tt=setTimeout($().time_tick,c.diff(b)))};$.weather_latlong=null;$.fn.weather_tt=0;$.fn.weather_configuration_changed=function(a){a.weather?(0==$.fn.weather_tt&&(null==$.weather_latlong?$().weather_requestLocation():$().weather_requestWeather()),$("#weather-block-1").css("display","inline-block"),$("#weather-block-2").css("display","inline-block")):($("#weather-block-1").css("display","none"),$("#weather-block-2").css("display","none"),clearTimeout($.fn.weather_tt),$.fn.weather_tt=0)};$.fn.weather_initialize=function(){};
$.fn.weather_requestLocation=function(){!$.app_Configuration.debug&&$.app_Configuration.weather?$.ajax({url:"http://geoip.nekudo.com/api/",type:"POST",dataType:"jsonp",success:function(a){$.fn.weather_tt=0;$.weather_latlong=[a.location.latitude,a.location.longitude];$().weather_requestWeather()},error:function(a,b,c){0!=$.fn.weather_tt&&(clearTimeout($.fn.weather_tt),$.fn.weather_tt=0);$.fn.weather_tt=setTimeout("$().weather_requestLocation()",6E4)}}):$().weather_requestWeather()};
$.fn.weather_requestWeather=function(){$.app_Configuration.debug?($.fn.weather_tt=0,$("#weather-icon-symbol").removeClass().addClass("wi wi-yahoo-30"),$("#weather-temp").html("38\x26#176;C"),$("#weather-maxmin").html("32\x26#176;|15\x26#176;")):$.simpleWeather({location:$.weather_latlong[0]+","+$.weather_latlong[1],unit:$.inArray((window.navigator.userLanguage||window.navigator.language).toLowerCase(),["en-us","en-ba","en-bz","en-pw"])?"c":"f",success:$().onWeatherSuccess=function(a){$.fn.weather_tt=
0;$("#weather-icon-symbol").removeClass().addClass("wi wi-yahoo-"+a.code);$("#weather-temp").html(a.temp+"\x26#176;"+a.units.temp);$("#weather-maxmin").html(a.high+"\x26#176;|"+a.low+"\x26#176;");0!=$.fn.weather_tt&&(clearTimeout($.fn.weather_tt),$.fn.weather_tt=0);$.fn.weather_tt=setTimeout("$().weather_requestWeather()",36E5)},error:$().onWeatherSuccess=function(a){0!=$.fn.weather_tt&&(clearTimeout($.fn.weather_tt),$.fn.weather_tt=0);$.fn.weather_tt=setTimeout("$().weather_requestWeather()",6E4)}})};